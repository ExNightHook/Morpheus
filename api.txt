API Keys nicepay:
ID мерчанта: 696179391f37cffbecb0afbd
Secret Key: b4UaD-BPAK9-sinXx-41W3q-ZNctr


Обработчик платежей
Установите ссылку на Ваш обработчик для получения уведомлений. По ней мы будем отправлять GET запросы о статусах платежей. Подробнее в документации



Создание платежа
Используйте Create Payment API для создания платежа и генерации ссылки на страницу оплаты для Вашего клиента. ID мерчанта и Secret Key можно найти на странице настроек мерчанта.

После отправки запроса Вы получите ответ с ID созданного платежа и ссылкой на оплату.

Получение ссылки на оплату
POST
https://nicepay.io/public/api/payment
Параметр	Тип параметра	Обязательный	По умолчанию	Описание
merchant_id	string	Yes	—	ID мерчанта из настроек
secret	string	Yes	—	Secret Key из настроек
order_id	string, max:50	Yes	—	ID платежа или клиента в Вашей системе
customer	string, max:50	Yes	—	Почта или логин клиента (для более быстрой поддержки клиентов)
amount	number	Yes	—	Сумма платежа в центах/копейках. Пример: 125.28 USD это 12528
currency	string	Yes	USD	Валюта платежа. Доступно: USD, EUR, RUB, UAH, KZT
description	string, max:150	—	—	Описание/комментарий к платежу. Показывается клиенту при оплате
method	string	—	—	Автовыбор метода после перехода на оплату. Используйте методы из Списка методов оплаты. Если метод не подключён к Вашему мерчанту, вы не сможете создать платёж
success_url	string	—	Merchant URL	URL перенаправления при успешной оплате. Если не указано, то открывается сайт мерчанта
fail_url	string	—	Merchant URL	URL перенаправления при ошибке при оплате. Если не указано, то открывается сайт мерчанта
Пример тела запроса на 35.40 USD
{
    "merchant_id": "657b475da365fbeb3e5cfaf6",
    "secret": "igDNT-tMppx-heMLB-Xjuw5-HIrdF",
    "order_id": "100423",
    "account": "user@gmail.com",
    "amount": 3540,
    "currency": "USD",
    "description": "Top up balance on website"
}
Ответ на запрос
JSON
Параметр	Тип параметра	Описание
payment_id	string	ID платежа в нашей системе
amount	number	Сумма платежа
currency	string	Валюта платежа
link	string	Ссылка на оплату
expired	unix	Время истечения платежа и переведения его в статус "Expired"
Пример успешного ответа на платёж в 123.50 USD
{
    "status": "success",
    "data": {
        "payment_id": "bVz657-bd8755-040148-6c9b6c-e47dld",
        "amount": 12350,
        "currency": "USD",
        "link": "https://nicepay.io/pay/657b458302a2e415c90bce69",
        "expired": "1702577504"
    }
}
Пример ошибочного ответа
{
    "status": "error",
    "data": {
        "message": "Error description"
    }
}




Обработчик платежей
Получение уведомления с информацией о платеже возможно при указанной ссылке на Ваш обработчик. Наша система отправляет запрос после финального статуса платежа на указунную Вами ссылку. При отсутсвии ответа от Вашего сервера система повторит запрос через 1 минуту.

Параметры уведомления
GET
Ссылка из настроек мерчанта
Параметр	Тип параметра	Описание
result	string	Финальный статус:
success - успешный платёж
error - платёж завершён с ошибкой
payment_id	string	ID платежа в NicePay
merchant_id	string	ID мерчанта из настроек
order_id	string	ID платежа или клиента в Вашей системе
amount	number	Сумма платежа в центах/копейках. Пример: 125.28 USD это 12528
amount_currency	string	Валюта платежа
profit	number	Сумма Вашего дохода в центах/копейках. Пример: 125.28 USD это 12528
profit_currency	string	Валюта дохода
method	string	Метод оплаты
hash	string	Цифровая подпись запроса. Подробная информация о ней описана ниже
Пример запроса о платеже на 56.70 USD
{
    "result": "success",
    "payment_id": "bVz657-bd8755-040148-6c9b6c-e47dld",
    "merchant_id": "657b475da365fbeb3e5cfaf6",
    "order_id": "100423",
    "amount": 5670,
    "amount_currency": "USD",
    "profit": 5370,
    "profit_currency": "USDT",
    "method": "paypal_usd",
    "hash": "c28021...60d72f"
}
Цифровая подпись запроса
Цифровая подпись звароса является строкой sha256 в которую доабвлены все параметры запроса, а также секретный ключ мерчанта.

Для генерация hash, выполните простые действия:

отсортируйте параметры запроса в алфавитном порядке (не забудьте убрать параметр hash)
добавьте в конец массива секретный ключ мерчанта
переводите массив в строку, разделяя элементы через {np}
закодируйте строку через sha256
Результат хэширования должен совпадать с передоваемым параметром hash.

sha256([параметры запроса через {np} и в алфавитном порядке]{np}секретный ключ)
Обработчик платежей на PHP
Для завершения платежа на Вашей стороны мы рекомендуем использовать наш обработчик. Если у Вас другой язык программирования, перепишите код, сохранив все основные проверки.

Обязательно проверяйте подпись запроса, который приходит на обработчик во избежании атак злоумышленников

<?php

$params = $_GET;
$secretKey = ''; //  Секретный ключ мерчанта

$hash = $params['hash'];
unset($params['hash']); // Удаляем из данных строку подписи
ksort($params, SORT_STRING); // Сортируем по ключам в алфавитном порядке элементы массива

array_push($params, $secretKey); // Добавляем в конец массива ключ
$hash_string = implode('{np}', $params); // Конкатенируем значения через символ "{np}"
$hash_sha256 = hash('sha256', $hash_string);

if ($hash != $hash_sha256) {
    echo json_encode(array('error' => array('message' => 'Invalid hash')));
    exit;
}

switch ($params['result']) {
    case "success":
        $payment_id = $params['payment_id'];

        echo json_encode(array('result' => array('message' => 'Success')));
        exit;
    break;
    case "error":
        $payment_id = $params['payment_id'];

        echo json_encode(array('error' => array('message' => 'Error')));
        exit;
    break;
    default:
        echo json_encode(array('error' => array('message' => 'Empty')));
        exit;
    break;
}

?>




Лимиты на платежи
В нашей системе существуют лимиты на сумму платежа в зависимости от выбранной валюты. Указывайте сумму в данном диапозоне, чтобы создать платеж через API.

Валюта	Минимальная сумма	Максимальная сумма
USD - Американский доллар	10 USD	990 USD
EUR - Евро	10 EUR	850 EUR
RUB - Российский рубль	200 RUB	85000 RUB
UAH - Украинская гривна	100 UAH	35000 UAH
KZT - Казахский тенге	1000 KZT	410000 KZT





Правила для мерчантов
Основные требования:
Сайт должен быть размещен на домене второго уровня и использовать платный хостинг.
Все ссылки на сайте должны быть активными и вести на соответствующие страницы.
Сайт не должен осуществлять продажу товаров, услуг или совершать действия, запрещенные законодательством или правилами международных платежных систем.
Четкое описание товаров или услуг, за которые требуется оплата, должно присутствовать на сайте.
Все технические работы должны быть завершены, содержание всех разделов сайта должно быть актуальным, без пустых или не работающих страниц.
Раздел "Контакты" должен содержать актуальную контактную информацию партнера (электронная почта, Telegram, форма обратной связи и т. д.).
Правила, пользовательское соглашение и политика возвратов должны быть доступны на открытой странице сайта.
Если деятельность требует лицензирования, на сайте должна быть представлена информация о наличии соответствующих лицензий. Также необходимо иметь согласие от производителя, правообладателя или государственных органов на продаваемые товары.
Для Telegram каналов: Канал должен оставаться публичным на протяжении всего периода работы.
Запрещённые к продаже товары и услуги:
Предоставление спонсорства, взносов и пожертвований без соответствующей лицензии.
Продажа запрещенных препаратов и биологически активных добавок (БАД).
Незаконный сбыт товаров, нарушающих права правообладателей.
Продажа программного обеспечения без заключения соответствующих договоров с поставщиками или разработчиками.
Торговля алкогольной продукцией, наркотиками и табаком.
Предоставление услуг файлового хостинга, телемаркетинга и распространение порнографического материала.
Продажа поддельных, копий или реплик товаров.
Предоставление услуг по подбору займов, магических/экстрасенсорных услуг, финансовых пирамид, инвестиционных проектов и телефонных розыгрышей.
Распространение продукции, пропагандирующей насилие или межнациональную рознь.
Предоставление услуг брачного агентства, женского и мужского эскорта, эротического массажа, а также продажа редких/экзотических животных.
Проведение медицинских консультаций и предоставление медицинских услуг онлайн с установлением диагноза.
Продажа реквизитов банковских карт и предоставление платного доступа к персональным данным.




Список методов оплаты
Полнвый перечень доступных методов оплаты по валютам. Ключи к методам оплаты обязательно указываются с валютой через нижний дефис.

RUB - Российский рубль
Название	Код	Тип
SBP	sbp_rub	P2P
Sberbank на карту	sberbank_rub	P2P
Sberbank по номеру счёта	sberbank_account_rub	P2P
Tinkoff Bank	tinkoff_rub	P2P
Alfabank	alfabank_rub	P2P
Raiffeisen	raiffeisen_rub	P2P
VTB Bank	vtb_rub	P2P
RNKB Bank	rnkbbank_rub	P2P
Pochta bank	postbank_rub	P2P
YooMoney	yoomoney_rub	P2P
AdvCash	advcash_rub	P2P
Payeer	payeer_rub	P2P
USDT - Криптовалюта USDT
Название	Код	Тип
NiceWallet	nicewallet_usdt	Wallet
UAH - Украинская гривна
Название	Код	Тип
Monobank	monobank_uah	P2P
Privat Bank	privatbank_uah	P2P
Raiffeisen	raiffeisen_uah	P2P
KZT - Казахский тенге
Название	Код	Тип
AdvCash	advcash_kzt	P2P
Kaspi Bank	kaspibank_kzt	P2P
Halyk Bank	halykbank_kzt	P2P
Jysan Bank	jysanbank_kzt	P2P
CenterCredit Bank	centercreditbank_kzt	P2P
ForteBank	fortebank_kzt	P2P
USD - Американский доллар
Название	Код	Тип
AdvCash	advcash_usd	P2P
Payeer	payeer_usd	P2P
PayPal	paypal_usd	P2P
EUR - Евро
Название	Код	Тип
AdvCash	advcash_eur	P2P
Payeer	payeer_eur	P2P
PayPal	paypal_eur	P2P


