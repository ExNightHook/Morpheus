Полностью перенести на vps сервер ubuntu, чтобы он располагался следующим образом.
Скрипт:
1) python, зависимости и тд
2) бесплатный https сертификат генерация и установка
3) расположение https://address/Morpheus Private/
4) генерация логина и пароля админ панели, его вывод в консоль

Дополнительно требуется перенести работу воркера в наш код. То есть по https://address/Morpheus Private/api/Stalcraft должен быть api как с воркера, то есть ключи, привязка ключей к пк, хранение, проверки на валидность и тд. Но пока не торопись прочти ТЗ дальше.

Тоесть итого что мы имеем - после вот мы только установили все, при запуске изначально бот работает но имеет статус отключён, если попробовать поговорить в такой момент с ботом то он напишет что бот временно отключён. Мы переходим по https://address/Morpheus Private/ и логинимся в панель, затем у нас есть доступ в панель администрирования ботом. В панели администрирования товаром является как отдельная подкатегория, у каждого товара хранятся свои проданные и не проданные ключи, а также билд лоадера (zip архив). В панели администрирования есть главный переключатель - как раз включение/отключение бота, также есть возможность оповещение для всех пользователей (текст). В панели администрирования мы видим - основные настройки бота, администраторы, пользователи, продукты (+api)

- Во вкладке основные настройки как раз самые важные данные бота - secret бота, включение/отключение, оповещение пользователей, включение/отключение технических работ.
- Во вкладке администраторы просто хранятся пользователи с id, которых бот будет принимать как администраторов.
- Во вкладке пользователи просто список пользователей а также их логи и статистика у каждого, кто что когда покупал и тд.
- Во вкладке продукты мы видим продукты, допустим мы нажали добавить новый продукт, называется "Sc12345", мы прописываем ему описание которое будет отображаться в карточке товара в боте либо можем оставить пустым, далее мы создаем и видим что есть у данного продукта добавить билд и добавить либо сгенерировать ключи, билд вместе с 1 ключом выдается пользователю после покупки данного продукта, ключ выданный пользователю переносится во вкладку проданные ключи. Также в карте товара у нас не просто сполным столбом лежат ключи, у ключей есть свои категории по длительности - 1/7/14/30/90 дней, под каждую категорию ключа указывается цена в рублях.

У ключей соответственно есть своя длительность, эта длительность активируется с момента первой активации ключа, тоесть ему может присвоиться статус проданного, но это одно дело поскольку человек может заранее просто купил, с момента первой авторизации по ключу ему присвоится уникальный uuid пк клиента пользователя и вот с этого момента ключ считается активированным.

У каждого продукта создается свой api автоматически, ссылка под api будет в зависимости от названия товара, если товар называется "Sc12345" то и api соответственно будет располагаться в /api/Sc12345. Ключи берутся те которые были проданы у данного товара У api есть всего одна функция:
1) /api/*product*/auth - регистрация/авторизация. Принимает key и uuid пользователя от клиента, отвечает клиенту успехом и оставшимся сроком подписки (дни и часы). Если ключ не найден то возвращаем клиенту ответ "Key mismatch".
Если ключ полностью нулевый не активированный (из заполненных полей это только сам ключ и длительность в днях и часах), то ключу присваивается uuid клиента и берётся текущее время и добавляется время длительности подписки и получается и присваивается дата окончания подписки. Если подписка уже активирована и имеет присвоенный uuid то он сверяется с полученным сейчас uuid от клиента, если uuid закрепленный за ключом и uuid в запросе различаются то выдаем ошибку "HWID mismatch".
Если подписка уже активирована, имеет дату окончания но поле uuid пустое то к данному ключу присваивается uuid полученный с запроса, при этом ключ заново не активируется, просто перепривязка uuid, к дате окончания не добавится повторно длительность подписки ведь она не была активирована повторно.

Интеграция для оплаты anypay, выдача ключа и тд


То есть со стороны пользователя:
Я смотрю товары которые в реальном времени обновляются да, выбрал продукт допустим "Sc12345", несмотря на то что вообще длительность подписки может быть 1/7/14/30/90, если например ключи в длительности 30 нет/закончились то мы попросту этот тип пользователю не отобразим и будет например 1/7/14/90. То есть пользователь нажимает  на карточку товара, у него открывается карточка и в низу после описания товара будет написано  чтобы он выбрал длительность подписки. У него такие же инлайн кнопки и выглядят примерно так:
"1 день • 299₽"
"7 дней • 899₽"
"14 дней • 999₽"
"90 дней • 2999₽"
После нажатия на нужный ему тип подписки у него обновится окошко и попросит подтвердить покупку:
"Подтвердите покупку:
*товар* *выбранный тип подписки и цена*.
После подтверждения вам предоставится страница для оплаты подписки, после успешной оплаты вы получите товар."
"Подтвердить"

После подтверждения бот генерирует в соответствии с его товаром, типом подписки у товара и тд ссылку где он оплачивает товар. На сервер отправится обратный вебхук что покупка совершена успешно, затем если все успешно то его купленный товар отсылается ему в сообщения от бота. Тоесть бот ему отсылает сообщение с прикреплённым zip архивом (билд товара) и его ключом (ключ переносится на сервере в категорию купленных), тоесть:
"*zip архив*
Ключ: MPH-XXXXX-XXXXX-XXXXX
Товар: *название и длительность*
Спасибо за покупку!"

Со стороны администратора в боте:
Все аналогично как и у пользователя. Единственное это пару доп функций - оповещение всем пользователям, включение/отключение технических работ.